import{u as P,j as e,a as A,y as L,r as a}from"./index-Dg8jzrxQ.js";const B=()=>{const h=P(),i=async()=>{try{await A.get("/auth/logout"),L.success("Logged out"),h("/login",{replace:!0})}catch(m){L.error(m?.response?.data?.message||"Failed to logout")}};return e.jsxs("button",{type:"button",onClick:i,className:"w-full flex items-center justify-center gap-2 bg-slate-100 hover:bg-slate-200 dark:bg-slate-800/70 dark:hover:bg-slate-700 text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-white/10 rounded-lg py-2",title:"Log out",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:"h-4 w-4","aria-hidden":"true",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6A2.25 2.25 0 005.25 5.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9l3 3m0 0l-3 3m3-3H3"})]}),"Logout"]})},F=({onNewChat:h,chats:i=[],activeId:m,onSelect:k,onRename:_,onDelete:S,mobileOpen:z=!1,onCloseMobile:w})=>{const[b,j]=a.useState(null),[y,p]=a.useState(""),[D,g]=a.useState(!1),c=a.useRef(null),[u,o]=a.useState(null),f=a.useRef(null),[l,d]=a.useState({open:!1,chat:null}),[x,N]=a.useState(!1);a.useEffect(()=>{b&&c.current&&(c.current.focus(),c.current.select())},[b]),a.useEffect(()=>{if(!u)return;const t=n=>{f.current&&!f.current.contains(n.target)&&o(null)},r=n=>{n.key==="Escape"&&o(null)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t,{passive:!0}),document.addEventListener("keydown",r),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t),document.removeEventListener("keydown",r)}},[u]),a.useEffect(()=>{if(!l.open)return;const t=r=>{r.key==="Escape"&&d({open:!1,chat:null})};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[l.open]);const M=t=>{j(t._id),p(t.title||"")},v=()=>{j(null),p(""),g(!1)},C=async t=>{const r=(y||"").trim();if(!r||r===t.title)return v();try{g(!0),await _?.(t._id,r),v()}catch{g(!1)}},E=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-3",children:e.jsx("button",{onClick:h,className:"w-full flex items-center justify-center gap-2 bg-slate-100 hover:bg-slate-200 dark:bg-slate-800/70 dark:hover:bg-slate-700 text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-white/10 rounded-lg py-2",children:"+ New Chat"})}),e.jsx("div",{className:"px-3 text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400",children:"Recent"}),e.jsxs("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[i.length===0&&e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400 px-2",children:"No chats yet"}),i.map(t=>{const n=`${m===t._id?"bg-sky-50 dark:bg-sky-900/20 border-sky-200 dark:border-sky-900":"bg-transparent"} w-full text-left px-3 py-2 rounded-lg border border-transparent text-sm text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800/50`;return b===t._id?e.jsx("div",{className:n,children:e.jsx("input",{ref:c,autoFocus:!0,disabled:D,value:y,onChange:s=>p(s.target.value),onBlur:()=>C(t),onKeyDown:s=>{s.stopPropagation(),s.key==="Enter"&&C(t),s.key==="Escape"&&v()},onMouseDown:s=>s.stopPropagation(),onClick:s=>s.stopPropagation(),className:"w-full bg-transparent outline-none text-slate-800 dark:text-slate-100"})},t._id):e.jsxs("div",{onClick:()=>k?.(t),role:"button",tabIndex:0,onKeyDown:s=>{s.key==="Enter"&&k?.(t)},className:`${n} group flex items-center justify-between gap-2 relative`,title:"Open chat",children:[e.jsx("span",{className:"truncate pr-2",children:t.title}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button","aria-haspopup":"menu","aria-expanded":u===t._id,onClick:s=>{s.stopPropagation(),o(R=>R===t._id?null:t._id)},className:"shrink-0 inline-flex h-7 w-7 items-center justify-center rounded-md text-slate-500 hover:text-slate-700 hover:bg-slate-100 dark:text-slate-400 dark:hover:text-slate-200 dark:hover:bg-slate-800 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",title:"More actions",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-4 w-4",children:e.jsx("path",{d:"M12 6.75a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5zm0 6a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5zm0 6a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5z"})})}),u===t._id&&e.jsxs("div",{ref:f,role:"menu",className:"absolute right-0 top-full mt-1 z-50 w-40 rounded-md border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900 shadow-lg py-1",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{type:"button",role:"menuitem",className:"w-full text-left px-3 py-2 text-sm text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800",onClick:()=>{o(null),M(t)},children:"Rename"}),e.jsx("button",{type:"button",role:"menuitem",className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30",onClick:()=>{o(null),d({open:!0,chat:t})},children:"Delete"})]})]})]},t._id)})]}),e.jsx("div",{className:"p-3 border-t border-slate-200 dark:border-white/10",children:e.jsx(B,{})})]});return e.jsxs(e.Fragment,{children:[e.jsx("aside",{className:"hidden md:flex md:flex-col w-64 h-full border-r border-slate-200 dark:border-white/10 bg-white/70 dark:bg-slate-900/40",children:e.jsx(E,{})}),z&&e.jsxs("div",{className:"md:hidden fixed inset-0 z-40",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:w}),e.jsxs("aside",{className:"absolute inset-y-0 left-0 w-72 max-w-[85vw] h-full border-r border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900 shadow-xl flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-slate-200 dark:border-white/10",children:[e.jsx("div",{className:"font-semibold text-slate-700 dark:text-slate-200",children:"Chats"}),e.jsx("button",{type:"button","aria-label":"Close sidebar",onClick:w,className:"inline-flex h-8 w-8 items-center justify-center rounded-md text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-slate-800",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-5 w-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(E,{})]})]}),l.open&&e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!x&&d({open:!1,chat:null})}),e.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-xl border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900 shadow-2xl p-5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-1 text-red-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-6 w-6",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-.75 6.75a.75.75 0 011.5 0v5.25a.75.75 0 01-1.5 0V9zm.75 8.25a1.125 1.125 0 100-2.25 1.125 1.125 0 000 2.25z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-100",children:"Delete chat?"}),e.jsxs("p",{className:"mt-1 text-sm text-slate-600 dark:text-slate-300",children:['This will permanently delete "',l.chat?.title,'" and all its messages. This action cannot be undone.']})]})]}),e.jsxs("div",{className:"mt-5 flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"px-4 py-2 rounded-md border border-slate-200 dark:border-white/10 text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-800",onClick:()=>d({open:!1,chat:null}),disabled:x,children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:x,onClick:async()=>{if(l.chat)try{N(!0),await S?.(l.chat._id),d({open:!1,chat:null})}finally{N(!1)}},children:x?"Deletingâ€¦":"Delete"})]})]})]})]})};export{F as default};
